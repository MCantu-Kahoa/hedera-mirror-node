SELECT
        ab.consensus_timestamp,
        ab.account_id,
        ab.balance,
        json_agg(
          json_build_object(
            'token_id', tb.token_id::text,
            'balance', tb.balance
          ) order by tb.token_id desc
        ) FILTER (WHERE tb.token_id IS NOT NULL) AS token_balances
      FROM account_balance ab
      LEFT JOIN token_balance tb
        ON ab.consensus_timestamp = tb.consensus_timestamp
          AND ab.account_id = tb.account_id


      WHERE ab.consensus_timestamp = (
      SELECT
        ab.consensus_timestamp
      FROM account_balance ab
      WHERE ab.consensus_timestamp >= $1
      ORDER BY ab.consensus_timestamp DESC
      LIMIT 1)
      GROUP BY ab.consensus_timestamp, ab.account_id
      ORDER BY ab.account_id desc
      limit $2  ["1646256002000000000",25]